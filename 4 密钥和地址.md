# 4 密钥和地址
You may have heard that bitcoin is based on cryptography, which is a branch of mathematics used extensively in computer security. Cryptography means "secret writing" in Greek, but the science of cryptography encompasses more than just secret writing, which is referred to as encryption. Cryptography can also be used to prove knowledge of a secret without revealing that secret (digital signature), or prove the authenticity of data (digital fingerprint). These types of cryptographic proofs are the mathematical tools critical to bitcoin and used extensively in bitcoin applications. </br>
你可能听说过，比特币是基于密码学，密码学是在计算机安全中广泛使用的一个数学分支。 
密码学在希腊语中的意思是“秘密书写”，但密码学不仅是秘密书写，还指加密。
密码学也可以用于：证明了解一个秘密，而不用揭示这个秘密（数字签名）；或证明数据的不会泄露秘密（数字签名），或证明数据的真实性（数字指纹）。
这些类型的密码学证明对比特币来说是关键的数学工具，并且在比特币应用中被广泛使用。

Ironically, encryption is not an important part of bitcoin, as its communications and transaction data are not encrypted and do not need to be encrypted to protect the funds. In this chapter we will introduce some of the cryptography used in bitcoin to control ownership of funds, in the form of keys, addresses, and wallets.</br>
然而，加密不是比特币的重要部分，比特币的通信和交易数据都没有被加密，也不需要加密来保护资金。
在本章中，我们介绍一些在比特币中用于控制资金所有权的密码学，形式是密钥、地址和钱包。

## 4.1 介绍
Ownership of bitcoin is established through digital keys, bitcoin addresses, and digital signatures. </br>
比特币的所有权是通过下列建立的：数字密钥、比特币地址、数字签名。

The digital keys are not actually stored in the network, but are instead created and stored by users in a file, or simple database, called a wallet. The digital keys in a user’s wallet are completely independent of the bitcoin protocol and can be generated and managed by the user’s wallet software without reference to the blockchain or access to the internet. Keys enable many of the interesting properties of bitcoin, including decentralized trust and control, ownership attestation, and the cryptographic-proof security model.</br>
数字密钥并不存储在网络中，而是由用户生成和存储，存储在文件或简单数据库（钱包）中。
用户钱包中的数字密钥完全独立于比特币协议，可由用户钱包软件生成和管理，而无需参考区块链或访问互联网。
密钥实现了比特币的许多有趣特性，包括去中心化信任和控制、所有权证明、密码证明安全模型。

Most bitcoin transactions require a valid digital signature to be included in the blockchain, which can only be generated with a secret key; therefore, anyone with a copy of that key has control of the bitcoin. The digital signature used to spend funds is also referred to as a witness, a term used in cryptography. The witness data in a bitcoin transaction testifies to the true ownership of the funds being spent.</br>
大多数比特币交易都需要一个有效的数字签名才会被存储在区块链中，数字签名只能用私钥生成；
因此，任何拥有私钥的人都可以控制那个比特币。
用于花费资金的数字签名也被称为见证（witness），这是密码学中使用的一个术语。
比特币交易中的见证数据证明了对花费的资金拥有所有权。

Keys come in pairs consisting of a private (secret) key and a public key. Think of the public key as similar to a bank account number and the private key as similar to the secret PIN, or signature on a check, that provides control over the account. These digital keys are very rarely seen by the users of bitcoin. For the most part, they are stored inside the wallet file and managed by the bitcoin wallet software.</br>
密钥是成对出现的，一个私钥，一个公钥。
公钥就像银行的账户，私钥就像支票上的签名，它提供对账户的控制。。
比特币的用户很少直接看到这些数字密钥。
多数情况下，比特币钱包软件把它们存储在钱包文件中，并管理它们。

In the payment portion of a bitcoin transaction, the recipient’s public key is represented by its digital fingerprint, called a bitcoin address, which is used in the same way as the beneficiary name on a check (i.e., "Pay to the order of"). In most cases, a bitcoin address is generated from and corresponds to a public key. However, not all bitcoin addresses represent public keys; they can also represent other beneficiaries such as scripts, as we will see later in this chapter. This way, bitcoin addresses abstract the recipient of funds, making transaction destinations flexible, similar to paper checks: a single payment instrument that can be used to pay into people’s accounts, pay into company accounts, pay for bills, or pay to cash. The bitcoin address is the only representation of the keys that users will routinely see, because this is the part they need to share with the world.</br>
在比特币交易的支付环节，收款人的公钥是用它的数字指纹来表示的，称为“比特币地址”，就像支票上的收款人姓名。
多数情况下，比特币地址由一个公钥生成，并与其对应。
然而，并非所有比特币地址都代表公钥，它们也可以代表其他支付对象，例如脚本，将在本章后面看到。
这样一来，比特币地址就是资金接收者的抽象，使得交易的目的地更加灵活，就像支票一样：可以支付给个人账户、公司账户、支付单支、支付现金。
比特币地址是用户经常看到的密钥的唯一表示，因为他们需要把这部分告诉其他人。

First, we will introduce cryptography and explain the mathematics used in bitcoin. Next, we will look at how keys are generated, stored, and managed. We will review the various encoding formats used to represent private and public keys, addresses, and script addresses. Finally, we will look at advanced use of keys and addresses: vanity, multisignature, and script addresses and paper wallets.</br>
首先，我们将介绍密码学，并解释在比特币中使用的数学知识。
然后，了解密钥如何被产生、存储和管理。
我们将了解各种编码格式，用于表示私钥和公钥、地址、脚本地址。
最后，介绍密钥和地址的高级用途：比特币靓号、多签名、脚本地址、纸钱包。

### 4.1.1 公钥密码学和加密货币
Public key cryptography was invented in the 1970s and is a mathematical foundation for computer and information security.</br>
公钥密码学发明于1970年代，它是计算机和信息安全的一个数学基础。

Since the invention of public key cryptography, several suitable mathematical functions, such as prime number exponentiation and elliptic curve multiplication, have been discovered. These mathematical functions are practically irreversible, meaning that they are easy to calculate in one direction and infeasible to calculate in the opposite direction. Based on these mathematical functions, cryptography enables the creation of digital secrets and unforgeable digital signatures. Bitcoin uses elliptic curve multiplication as the basis for its cryptography.</br>
自从发明了公钥密码学之后，已经发现了一些合适的数学函数，例如：素数求幂和椭圆曲线乘法。
这些数学函数都是不可逆的，就是说，很容易在一个方向上计算，但无法在反方向上计算。
基于这些数学函数，密码学能够创建数字秘密和不可伪造的数字签名。
比特币使用椭圆曲线乘法作为其密码学的基础。

In bitcoin, we use public key cryptography to create a key pair that controls access to bitcoin. The key pair consists of a private key and—derived from it—a unique public key. The public key is used to receive funds, and the private key is used to sign transactions to spend the funds.</br>
在比特币中，我们用公钥密码学创建一个密钥对，用于控制比特币。
密钥对包括一个私钥和一个公钥（用私钥生成）。
公钥用于接收资金，私钥用于对交易进行签名，以花费资金。

There is a mathematical relationship between the public and the private key that allows the private key to be used to generate signatures on messages. This signature can be validated against the public key without revealing the private key.</br>
公钥和私钥之间有一个数学关系，使得可以使用私钥对消息生成签名。
可以用公钥验证这个签名，而不需要泄露私钥。

When spending bitcoin, the current bitcoin owner presents her public key and a signature (different each time, but created from the same private key) in a transaction to spend those bitcoin. Through the presentation of the public key and signature, everyone in the bitcoin network can verify and accept the transaction as valid, confirming that the person transferring the bitcoin owned them at the time of the transfer.</br>
当花费比特币时，比特币的当前所有者需要在交易中提供他的公钥和签名（签名每次都不同，但都是用同一私钥生成的）。
通过提交公钥和签名，比特币网络中的所有人都可以验证和承认这个交易是有效的，确认转钱的这个人对比特币有所有权。

Tip：In most wallet implementations, the private and public keys are stored together as a key pair for convenience. However, the public key can be calculated from the private key, so storing only the private key is also possible.</br>
提示：在大多数钱包中，为了方便，是把私钥和公钥作为一个密钥对来存储的。
但是，可以用私钥计算得到公钥，所以也可以只存储私钥。

### 4.1.2 私钥和公钥
A bitcoin wallet contains a collection of key pairs, each consisting of a private key and a public key. The private key (k) is a number, usually picked at random. From the private key, we use elliptic curve multiplication, a one-way cryptographic function, to generate a public key (K). From the public key (K), we use a one-way cryptographic hash function to generate a bitcoin address (A). </br>
比特币钱包中包含一些密钥对，每个密钥对有一个私钥和一个公钥。
私钥（k）是一个数字，通常是随机选择的数字。
有了私钥，就可以使用椭圆曲线乘法来生成公钥（K），椭圆曲线乘法是一个单向加密函数。
有了公钥（K），再使用一个单向加密哈希函数生成比特币地址（A）。

In this section, we will start with generating the private key, look at the elliptic curve math that is used to turn that into a public key, and finally, generate a bitcoin address from the public key. The relationship between private key, public key, and bitcoin address is shown in Private key, public key, and bitcoin address.</br>
本节从生成私钥开始，讲述椭圆曲线运算如何用私钥生成公钥，最后在用公钥生成比特币地址。
下图显示了私钥、公钥、比特币地址之间的关系。

![](https://github.com/BtcGroupCn/MasterBitcoin2ndCn/blob/master/images/mbc2_0401.png)</br>
**Figure 1. Private key, public key, and bitcoin address**

**Why Use Asymmetric Cryptography (Public/Private Keys)?**</br>
**为什么使用非对称密码学（公钥/私钥）？**

Why is asymmetric cryptography used in bitcoin? It’s not used to "encrypt" (make secret) the transactions. Rather, the useful property of asymmetric cryptography is the ability to generate digital signatures. A private key can be applied to the digital fingerprint of a transaction to produce a numerical signature. This signature can only be produced by someone with knowledge of the private key. However, anyone with access to the public key and the transaction fingerprint can use them to verify the signature. This useful property of asymmetric cryptography makes it possible for anyone to verify every signature on every transaction, while ensuring that only the owners of private keys can produce valid signatures.</br>
为什么在比特币中使用非对称密码学？ 
非对称密码学不是用于对交易进行“加密”（使交易成为秘密）。
非对称密码学的有用特性是能够生成数字签名。可以对交易的数字指纹应用一个私钥，从而生成一个数字签名。这个签名只能由知道私钥的人生成。但是，任何知道公钥和交易指纹的人都可以使用它们来验证这个签名。
这个特性使得每个人都可以验证每笔交易的每个签名，同时保证：只有私钥的所有者能生成有效的签名。

### 4.1.3 私钥
A private key is simply a number, picked at random. Ownership and control over the private key is the root of user control over all funds associated with the corresponding bitcoin address. The private key is used to create signatures that are required to spend bitcoin by proving ownership of funds used in a transaction. The private key must remain secret at all times, because revealing it to third parties is equivalent to giving them control over the bitcoin secured by that key. The private key must also be backed up and protected from accidental loss, because if it’s lost it cannot be recovered and the funds secured by it are forever lost, too.</br>
私钥只是随机选出的一个数字。
对私钥的所有权和控制，是对相应比特币地址关联的资金的控制的根本。
在花费比特币时，私钥用于创建签名，以证明对资金的所有权。
私钥必须始终保密，因为一旦被泄露，别人就能用它控制你的比特币了。
私钥还必须进行备份，以防意外丢失，因为一旦丢失，就无法复原，你的比特币也就丢了。

Tip：The bitcoin private key is just a number. You can pick your private keys randomly using just a coin, pencil, and paper: toss a coin 256 times and you have the binary digits of a random private key you can use in a bitcoin wallet. The public key can then be generated from the private key.</br>
提示：比特币私钥只是一个数字。
你可以用硬币、铅笔和纸来随机选择你的私钥：掷硬币256次，正面为1，反面为0，用笔和纸记录袭来，你就得到了一个私钥，可以在比特币钱包中使用。
然后，用这个私钥可以生成对应的公钥。

**Generating a private key from a random number**</br>
**从一个随机数生成一个私钥**

The first and most important step in generating keys is to find a secure source of entropy, or randomness. Creating a bitcoin key is essentially the same as "Pick a number between 1 and 2256." The exact method you use to pick that number does not matter as long as it is not predictable or repeatable. Bitcoin software uses the underlying operating system’s random number generators to produce 256 bits of entropy (randomness). Usually, the OS random number generator is initialized by a human source of randomness, which is why you may be asked to wiggle your mouse around for a few seconds.</br>
第一步也是最重要的一步，是找到一个安全的随机源（熵，平均信息量）。
创建一个比特币密钥实际上等同于：在1 到2256之间选一个数字。
选择数字的方法并不重要，只要它不是可预测的或重复的。
比特币软件使用操作系统底层的随机数生成器来产生256位的随机数。
通常情况下，操作系统随机数生成器由一个人工随机源来进行初始化，这就是为什么你会被要求晃动鼠标几秒钟。

More precisely, the private key can be any number between 0 and n - 1 inclusive, where n is a constant (n = 1.1578 * 1077, slightly less than 2256) defined as the order of the elliptic curve used in bitcoin (see Elliptic Curve Cryptography Explained). To create such a key, we randomly pick a 256-bit number and check that it is less than n. In programming terms, this is usually achieved by feeding a larger string of random bits, collected from a cryptographically secure source of randomness, into the SHA256 hash algorithm, which will conveniently produce a 256-bit number. If the result is less than n, we have a suitable private key. Otherwise, we simply try again with another random number.</br>
更准确地说，私钥可以是1和n-1之间的任何数字，n是一个常数（n=1.158 * 1077，略小于2256），被定义为由比特币所使用的椭圆曲线的阶。
为了生成这样一个私钥，我们随机选择一个256位的数字，并确认它是小于n。
在编程中，一般是这样实现的：输入一个很长的字符串（随机比特），它来自一个随机加密安全源，使用SHA256哈希算法将其转换为一个256位数字。如果运算结果小于n，我们就得到了一个私钥。否则，就用另一个随机数再试一次。

Warning：Do not write your own code to create a random number or use a "simple" random number generator offered by your programming language. Use a cryptographically secure pseudorandom number generator (CSPRNG) with a seed from a source of sufficient entropy. Study the documentation of the random number generator library you choose to make sure it is cryptographically secure. Correct implementation of the CSPRNG is critical to the security of the keys.</br>
警告：不要自己写代码来生成随机数，或使用编程语言提供的简单随机数生成器来获得随机数。
使用加密安全伪随机数生成器（CSPRNG），并用来自一个足够随机源的一个种子。
研究一下你所选择的随机数生成器库的文档，确保它是加密安全的。
CSPRNG的正确实现对于密钥的安全至关重要。

The following is a randomly generated private key (k) shown in hexadecimal format (256 bits shown as 64 hexadecimal digits, each 4 bits):</br>
下面是一个随机生成的私钥（k），显示的是十六进制格式（256位表示为64个十六进制数字）。

```html
1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD
```

Tip：The size of bitcoin’s private key space, ($$2^256$$) is an unfathomably large number. It is approximately $$10^77$$ in decimal. For comparison, the visible universe is estimated to contain $$10^80$$ atoms.</br>
提示：比特币私钥空间的大小是$$2^256$$，这是一个非常非常大的数字。
十进制表示大约是$$10^77$$，而据估计，可见宇宙只含有$$10^80$$个原子。


